function reset(){dt.api().ajax.reload()}function idleTimer(){function i(){window.location=self.location.href}function n(){clearTimeout(t);t=setTimeout(i,5e4)}var t;window.onload=n;window.onmousemove=n;window.onmousedown=n;window.onclick=n;window.onscroll=n;window.onkeypress=n}function ConfirmAccess(n,t){var i="accessedSpan_"+n,r="confirmaccessedSpan_"+n;t?($("#"+i).hide(),$("#"+r).show()):($("#"+i).show(),$("#"+r).hide())}function Accessed(n){var t=$("#__AjaxAntiForgeryForm"),i=$('input[name="__RequestVerificationToken"]',t).val();$.ajax({type:"POST",url:"/Turns/Accessed",data:{__RequestVerificationToken:i,id:n},success:function(n){return n.trim().length==0&&Swal.fire({position:"top-end",icon:"info",title:"no quedan turnos!",showConfirmButton:!1,timer:1200}),Swal.fire({position:"top-end",icon:"success",title:"Paciente accedio correctamente",showConfirmButton:!1,timer:1200}),reset()},error:function(){}})}function Delete(n){var t=$("#__AjaxAntiForgeryForm"),i=$('input[name="__RequestVerificationToken"]',t).val();$.ajax({type:"DELETE",url:"/Turns/Delete",data:{__RequestVerificationToken:i,id:n},success:function(){return Swal.fire({position:"top-end",icon:"info",title:"Turno eliminado Correctamente.",showConfirmButton:!1,timer:1200}),reset()},error:function(){}})}function ConfirmDelete(n,t){var i="accessedSpan_"+n,r="confirmaccessedSpan_"+n;t?($("#"+i).hide(),$("#"+r).show()):($("#"+i).show(),$("#"+r).hide())}function Create(n){var t=$("#__AjaxAntiForgeryForm"),i=$('input[name="__RequestVerificationToken"]',t).val();$.ajax({type:"POST",url:n,dataType:"json",contentType:"application/json",data:{__RequestVerificationToken:i,Name:$("#clientName").val(),Dni:$("#dniCliente").val(),MedicId:$("#medicId :selected").val(),TimeId:$("#timeTurn :selected").val(),DateTurn:$("#dateTurn").val(),SocialWork:$("#socialWork").val(),Reason:$("#reason").val()},success:function(){Swal.fire({position:"top-end",icon:"success",title:"Turno creado correctamente.",showConfirmButton:!1,timer:1200})}})}function AddNumber(){$("#pNumber").val(parseInt($("#pNumber").val())+1)}function RemNumber(){$("#pNumber").val(parseInt($("#pNumber").val())-1)}var dt,currentDate,time;$(document).ready(function(){new DateTime(document.getElementById("DateTurn"),{format:"DD/MM/YYYY",i18n:{previous:"Anterior",next:"Siguiente",months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],weekdays:["Dom","Lun","Mar","Mié","Jue","Vie","Sab"]},disableDays:[0]});dt=$("#turns").dataTable({processing:!0,serverSide:!0,bFilter:!0,bDestroy:!0,bJQueryUI:!0,responsive:!0,ordering:!0,orderMulti:!0,autoWidth:!0,order:[[7,"asc"]],dom:'<"row"<"col-md-6 col-sm-12"B>><"row table-responsive"rt><"row"<"col-md-6 col-sm-12"i><"col-md-6 ms-auto"p>>',language:{lengthMenu:"Mostrando _MENU_ filas por página",zeroRecords:"No se encontro registro",info:"Mostrando página _PAGE_ de _PAGES_",infoEmpty:"No se encontraron resultados",infoFiltered:"(Filtrado de _MAX_ total )",search:"Buscar:",paginate:{first:"Primera",last:"Última",next:"Siguiente",previous:"Anterior"},buttons:{pageLength:{_:"Mostrando %d filas","-1":"Todas las filas"},collection:"Exportar"}},ajax:{url:"/Turns/InitializeTurns",type:"Post",datatype:"json"},columns:[{data:"name",name:"Name"},{data:"dni",name:"Dni"},{data:"socialWork",name:"Social Work"},{data:"reason",name:"Reason"},{data:"medicName",name:"Medic"},{data:"medicId",name:"MedicId"},{data:"date",name:"Date"},{data:"time",name:"Time"},{data:null},],columnDefs:[{targets:[-1],data:null,render:function(n){return n.accessed==!1&&n.isMedic==!1?'<a href="/Turns/Edit/'+n.id+'" class="btn btn-secondary">Editar<\/a><span id="confirmaccessedSpan_'+n.id+'" style="display:none"><button onclick="Delete(\''+n.id+'\');" class="btn btn-danger">Si<\/button><a href="#" class="btn btn-primary"onclick="ConfirmDelete(\''+n.id+'\', false)">No<\/a><\/span ><span id="accessedSpan_'+n.id+'"><a href="#" class="btn btn-danger"onclick="ConfirmDelete(\''+n.id+"', true)\">Eliminar<\/a><\/span>":n.accessed==!1&&n.isMedic==!0?'<span id="confirmaccessedSpan_'+n.id+'" style = "display:none"><button onclick = "Accessed(\''+n.id+'\')" class="btn btn-danger"> Si<\/button><a href="#" class="btn btn-primary" onclick="ConfirmAccess(\''+n.id+'\', false)">No<\/a><\/span><span id="accessedSpan_'+n.id+'"><a href="#" class="btn btn-primary" onclick="ConfirmAccess(\''+n.id+"', true)\">Ingreso<\/a><\/span> ":""}},{target:5,visible:!1,searchable:!0},{responsivePriority:-1,targets:0}],createdRow:function(n,t){t.accessed==!0&&$(n).addClass("Red")},lengthMenu:[[10,25,50,-1],["10 filas","25 filas","50 filas","Todo"]],buttons:[{extend:"collection",className:"btn btn-primary",buttons:[{extend:"excelHtml5",title:"Turnos",exportOptions:{columns:[0,1,2,3,4,6,7]}},{extend:"pdfHtml5",download:"open",orientation:"landscape",pageSize:"A4",title:"Turnos",exportOptions:{columns:[0,1,2,3,4,6,7]}},]},"pageLength",{text:"Recarga",className:"btn btn-primary",action:function(){reset()}}]});oTable=$("#turns").DataTable();$("#btnSearch").click(function(){oTable.columns(5).search($("#Medics").val().trim());oTable.columns(6).search($("#DateTurn").val().trim());oTable.draw()})});$(function(){$("#createTurn").click(function(){$.ajax({type:"GET",url:"/Turns/Create",success:function(n){$("#CreateEdit").find(".modal-body").html(n);$("#CreateEdit").modal("show")},failure:function(n){alert(n.responseText)},error:function(n){alert(n.responseText)}})})});currentDate="";time="";$(window).on("load",function(){var n=new Date,t=n.getDate(),i=n.getMonth()+1,f=n.getFullYear(),r=n.getHours(),u=n.getMinutes();r<10&&(r="0"+r);u<10&&(u="0"+u);t<10&&(t="0"+t);i<10&&(i="0"+i);currentDate=f+"-"+i+"-"+t;time=r+":"+u});